<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Fullstack Prep Hub - Premium</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üöÄ</text></svg>"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
      rel="stylesheet"
      id="prism-theme-link"
    />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-jsx.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>

    <style>
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap");

      :root {
        --bg-dark: #0f172a;
        --card-dark: #1e293b;
      }

      body {
        background-color: var(--bg-dark);
        color: #e2e8f0;
        font-family: "Inter", sans-serif;
        margin: 0;
      }

      /* --- PREMIUM ANIMATIONS --- */
      @keyframes premiumTabEnter {
        0% {
          opacity: 0;
          transform: translateY(12px) scale(0.99);
          filter: blur(4px);
        }
        100% {
          opacity: 1;
          transform: translateY(0) scale(1);
          filter: blur(0);
        }
      }

      .animate-tab-content {
        animation: premiumTabEnter 0.5s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
      }

      .animation-fade-in {
        animation: premiumTabEnter 0.4s ease-out forwards;
      }

      /* --- SCROLLBAR UTILS --- */
      /* Hide scrollbar for Chrome, Safari and Opera */
      .no-scrollbar::-webkit-scrollbar {
        display: none;
      }
      /* Hide scrollbar for IE, Edge and Firefox */
      .no-scrollbar {
        -ms-overflow-style: none; /* IE and Edge */
        scrollbar-width: none; /* Firefox */
      }

      /* Custom Global Scrollbar */
      ::-webkit-scrollbar {
        width: 6px;
        height: 6px;
      }
      ::-webkit-scrollbar-track {
        background: transparent;
      }
      ::-webkit-scrollbar-thumb {
        background: #334155;
        border-radius: 10px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #475569;
      }

      .card-hover {
        transition: all 0.3s ease;
      }
      .card-hover:hover {
        transform: translateY(-4px);
        box-shadow: 0 10px 30px -10px rgba(16, 185, 129, 0.15); /* Emerald glow for general */
      }

      .vertical-text {
        writing-mode: vertical-rl;
        text-orientation: mixed;
        transform: rotate(180deg);
      }

      .dark-select {
        appearance: none;
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%2394a3b8' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
        background-position: right 0.5rem center;
        background-repeat: no-repeat;
        background-size: 1.5em 1.5em;
        padding-right: 2.5rem;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>

    <script src="./data.js"></script>
    <script src="./design-data.js"></script>

    <script type="text/babel">
      const { useState, useMemo, useEffect, useRef } = React;

      // =========================================
      // 0. DATA INJECTION (SYSTEM DESIGN)
      // =========================================
   
      // =========================================
      // 1. ICONS
      // =========================================
      const IconBase = ({ children, size = 16, className = "" }) => (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width={size}
          height={size}
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          strokeWidth="2"
          strokeLinecap="round"
          strokeLinejoin="round"
          className={className}
        >
          {children}
        </svg>
      );
      const ChevronLeft = (p) => (
        <IconBase {...p}>
          <path d="m15 18-6-6 6-6" />
        </IconBase>
      );
      const ChevronRight = (p) => (
        <IconBase {...p}>
          <path d="m9 18 6-6-6-6" />
        </IconBase>
      );
      const ChevronDown = (p) => (
        <IconBase {...p}>
          <path d="m6 9 6 6 6-6" />
        </IconBase>
      );
      const Play = (p) => (
        <IconBase {...p}>
          <polygon points="5 3 19 12 5 21 5 3" />
        </IconBase>
      );
      const RotateCcw = (p) => (
        <IconBase {...p}>
          <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8" />
          <path d="M3 3v5h5" />
        </IconBase>
      );
      const AlertCircle = (p) => (
        <IconBase {...p}>
          <circle cx="12" cy="12" r="10" />
          <line x1="12" x2="12" y1="8" y2="12" />
          <line x1="12" x2="12.01" y1="16" y2="16" />
        </IconBase>
      );

      // =========================================
      // 2. UTILS & SHARED COMPONENTS
      // =========================================
      const updateURL = (params) => {
        try {
          const url = new URL(location);
          Object.keys(params).forEach((key) => {
            if (params[key] === null) url.searchParams.delete(key);
            else url.searchParams.set(key, params[key]);
          });
          history.pushState({}, "", url);
        } catch (e) {
          console.warn("URL update skipped.");
        }
      };

      // Syntax Highlighter Component
      const SyntaxHighLighter = ({
        codeString = "",
        language = "javascript",
        output = null,
      }) => {
        const [copied, setCopied] = useState(false);
        const [isDark, setIsDark] = useState(true);

        useEffect(() => {
          if (Prism) Prism.highlightAll();
        }, [codeString, isDark]);

        const handleCopy = async () => {
          await navigator.clipboard.writeText(codeString || output || "");
          setCopied(true);
          setTimeout(() => setCopied(false), 1500);
        };

        return (
          <div
            style={{
              position: "relative",
              borderRadius: 8,
              overflow: "hidden",
              fontFamily: "monospace",
              marginTop: 10,
              marginBottom: 10,
              border: isDark ? "1px solid #334155" : "1px solid #ccc",
              backgroundColor: isDark ? "#2d2d2d" : "#f5f5f5",
              color: isDark ? "#fff" : "#000",
            }}
          >
            <div
              style={{
                display: "flex",
                justifyContent: "space-between",
                alignItems: "center",
                padding: "6px 12px",
                background: isDark ? "#1e1e1e" : "#e6e6e6",
                borderBottom: isDark ? "1px solid #333" : "1px solid #ddd",
                fontSize: 13,
              }}
            >
              <span style={{ fontWeight: "bold", opacity: 0.8 }}>
                {language.toUpperCase()}
              </span>
              <div style={{ display: "flex" }}>
                <button
                  onClick={handleCopy}
                  style={{
                    background: "transparent",
                    border: `1px solid ${isDark ? "#666" : "#999"}`,
                    padding: "2px 8px",
                    borderRadius: 4,
                    cursor: "pointer",
                    fontSize: 12,
                    color: isDark ? "#fff" : "#333",
                  }}
                >
                  {copied ? "‚úÖ" : "üìã"}
                </button>
              </div>
            </div>
            {codeString && (
              <div
                style={{ padding: "16px", overflowX: "auto", fontSize: "14px" }}
              >
                <pre className={`language-${language}`} style={{ margin: 0 }}>
                  <code>{codeString.trim()}</code>
                </pre>
              </div>
            )}
            {output && (
              <div
                style={{
                  background: isDark ? "#1e1e1e" : "#fafafa",
                  color: isDark ? "#00ff88" : "#333",
                  padding: "12px",
                  borderTop: isDark ? "1px solid #444" : "1px solid #ddd",
                  fontSize: "12px",
                  overflowX: "auto",
                }}
              >
                <strong
                  style={{
                    display: "block",
                    marginBottom: 6,
                    color: isDark ? "#4ade80" : "#15803d",
                  }}
                >
                  Output:
                </strong>
                <pre style={{ margin: 0 }}>{output}</pre>
              </div>
            )}
          </div>
        );
      };

      const UniversalCard = ({
        id,
        title,
        subtitle,
        meta,
        category,
        onClick,
      }) => (
        <div
          onClick={onClick}
          className="relative group card-hover bg-[#1e293b] border border-slate-700 rounded-xl shadow-md cursor-pointer overflow-hidden h-full min-h-[180px]"
        >
          <div className="p-5 pr-12 flex flex-col h-full justify-between">
            <div>
              <div className="flex justify-between items-start mb-2">
                <span className="text-xs text-slate-500 font-mono">
                  ID: {id}
                </span>
              </div>
              <h3 className="text-lg font-bold text-white mb-2 group-hover:text-emerald-400 transition leading-tight">
                {title}
              </h3>
              <p className="text-sm text-slate-400 line-clamp-2 mb-3 font-medium">
                {subtitle}
              </p>
            </div>
            {meta && (
              <div className="pt-3 border-t border-slate-700 flex gap-4 text-xs text-slate-500 font-mono">
                {meta}
              </div>
            )}
          </div>
          <div className="absolute right-0 top-0 bottom-0 w-8 bg-slate-800/50 border-l border-slate-700 flex items-center justify-center hover:bg-slate-700 transition">
            <div className="vertical-text text-[10px] font-bold text-emerald-400 tracking-widest whitespace-nowrap overflow-hidden text-ellipsis">
              {category ? category.toUpperCase() : "GENERAL"}
            </div>
          </div>
        </div>
      );

      const LogViewer = ({ logs }) => {
        const groupedLogs = useMemo(() => {
          if (!logs || logs.length === 0) return [];
          const groups = [];
          let currentGroup = null;
          logs.forEach((log) => {
            const isPassHeader =
              typeof log === "string" && log.trim().match(/^Pass \d+:/);
            if (isPassHeader) {
              if (currentGroup) groups.push(currentGroup);
              currentGroup = { title: log, items: [] };
            } else {
              if (!currentGroup) currentGroup = { title: "Log", items: [] };
              currentGroup.items.push(log);
            }
          });
          if (currentGroup) groups.push(currentGroup);
          return groups;
        }, [logs]);

        return (
          <div className="space-y-2 font-mono text-sm text-slate-300 max-h-[300px] overflow-y-auto pr-2 custom-scrollbar bg-slate-900/50 p-2 rounded border border-slate-800">
            {groupedLogs.map((group, idx) => (
              <div key={idx} className="mb-2">
                <div className="font-bold text-blue-400 mb-1">
                  {group.title}
                </div>
                {group.items.map((it, i) => (
                  <div
                    key={i}
                    className="pl-2 border-l border-slate-700 text-xs py-0.5"
                  >
                    {it}
                  </div>
                ))}
              </div>
            ))}
          </div>
        );
      };

      // =========================================
      // 3. DOMAIN VIEWS
      // =========================================

      // --- REACT VIEW ---
      const ReactDetail = ({ question, onBack }) => {
        useEffect(() => updateURL({ id: question.id }), [question.id]);
        return (
          <div className="p-6 bg-[#1e293b] rounded-xl border border-slate-700 animation-fade-in">
            <button
              onClick={onBack}
              className="mb-4 text-blue-400 hover:text-blue-300 font-semibold flex items-center gap-2"
            >
              <ChevronLeft size={16} /> Back
            </button>
            <h1 className="text-2xl font-bold text-white mb-2">
              <span className="text-blue-500">Q{question.id}:</span>{" "}
              {question.title}
            </h1>
            <span className="bg-blue-500/10 text-blue-400 px-2 py-1 rounded text-xs border border-blue-500/20">
              {question.category}
            </span>
            <div className="mt-6">
              <h3 className="text-lg font-semibold text-white mb-2">
                Explanation
              </h3>
              <SyntaxHighLighter
                codeString={question.explanation}
                language="text"
              />
              <h3 className="text-lg font-semibold text-white mt-4 mb-2">
                Code
              </h3>
              <SyntaxHighLighter
                codeString={question.codeString}
                language="jsx"
              />
            </div>
          </div>
        );
      };

      const ReactView = ({ initialId }) => {
        const [selected, setSelected] = useState(null);
        // Safely fallback if reactQuestionsData is missing
        const data = reactQuestionsData || [];

        useEffect(() => {
          if (initialId && data.length)
            setSelected(data.find((q) => q.id.toString() === initialId));
        }, [initialId, data]);

        if (selected)
          return (
            <ReactDetail
              question={selected}
              onBack={() => {
                setSelected(null);
                updateURL({ id: null });
              }}
            />
          );

        return (
          <div className="animation-fade-in">
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
              {data.map((q) => (
                <UniversalCard
                  key={q.id}
                  id={q.id}
                  title={q.title}
                  subtitle={q.explanation}
                  category={q.category}
                  onClick={() => setSelected(q)}
                />
              ))}
            </div>
            {data.length === 0 && (
              <div className="text-center text-slate-500 py-10">
                No React data loaded. Ensure data.js is linked.
              </div>
            )}
          </div>
        );
      };

      // --- DSA VIEW ---
      const DSADetail = ({ item, onBack }) => {
        const [logs, setLogs] = useState(null);
        useEffect(() => updateURL({ id: item.id }), [item.id]);

        const handleRun = () => {
          if (item.dryRunFunc) {
            try {
              setLogs(item.dryRunFunc([10, 5, 3, 8, 2]));
            } catch (e) {
              console.error(e);
            }
          }
        };

        return (
          <div className="p-6 bg-[#1e293b] rounded-xl border border-slate-700 animation-fade-in">
            <button
              onClick={onBack}
              className="mb-4 text-purple-400 font-semibold flex items-center gap-2"
            >
              <ChevronLeft size={16} /> Back
            </button>
            <h1 className="text-2xl font-bold text-white">{item.title}</h1>
            <div className="flex gap-3 text-sm font-mono text-slate-400 mt-2 mb-6">
              <span className="text-green-400">‚è± {item.timeComplexity}</span>
              <span className="text-purple-400">üíæ {item.spaceComplexity}</span>
            </div>
            <div className="grid lg:grid-cols-2 gap-6">
              <div>
                <h3 className="font-bold text-white mb-2">Algorithm</h3>
                <p className="text-slate-300 text-sm mb-4">{item.algorithm}</p>
                <button
                  onClick={handleRun}
                  className="bg-purple-600 hover:bg-purple-500 text-white px-4 py-2 rounded text-sm font-bold flex items-center gap-2"
                >
                  <Play size={14} /> Run Demo
                </button>
                {logs && (
                  <div className="mt-4">
                    <LogViewer logs={logs} />
                  </div>
                )}
              </div>
              <div>
                <SyntaxHighLighter codeString={item.code} />
              </div>
            </div>
          </div>
        );
      };

      const DSAView = ({ initialId }) => {
        const [selected, setSelected] = useState(null);
        const data = dsaAlgorithms || [];

        useEffect(() => {
          if (initialId && data.length)
            setSelected(data.find((i) => i.id.toString() === initialId));
        }, [initialId, data]);

        if (selected)
          return (
            <DSADetail
              item={selected}
              onBack={() => {
                setSelected(null);
                updateURL({ id: null });
              }}
            />
          );

        return (
          <div className="animation-fade-in">
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
              {data.map((item) => (
                <UniversalCard
                  key={item.id}
                  id={item.id}
                  title={item.title}
                  subtitle={item.algorithm}
                  category={item.category}
                  onClick={() => setSelected(item)}
                />
              ))}
            </div>
          </div>
        );
      };

      // --- SYSTEM DESIGN VIEW ---
      const DesignDetail = ({ item, onBack }) => {
        useEffect(() => updateURL({ id: item.id }), [item.id]);
        return (
          <div className="p-6 bg-[#1e293b] rounded-xl border border-slate-700 animation-fade-in">
            <button
              onClick={onBack}
              className="mb-4 text-emerald-400 font-semibold flex items-center gap-2"
            >
              <ChevronLeft size={16} /> Back
            </button>
            <h1 className="text-2xl font-bold text-white">{item.title}</h1>
            <div className="mt-6 space-y-6">
              <div>
                <h3 className="text-lg font-semibold text-white mb-2">
                  üìê Concept
                </h3>
                <SyntaxHighLighter
                  codeString={item.explanation}
                  language="text"
                />
              </div>
              <div>
                <h3 className="text-lg font-semibold text-white mb-2">
                  üí° Pro Tips
                </h3>
                <SyntaxHighLighter codeString={item.tips} language="text" />
              </div>
              {item.codeString && (
                <div>
                  <h3 className="text-lg font-semibold text-white mb-2">
                    üíª Implementation
                  </h3>
                  <SyntaxHighLighter codeString={item.codeString} />
                </div>
              )}
            </div>
          </div>
        );
      };

      const DesignView = ({ initialId }) => {
        const [selected, setSelected] = useState(null);
        useEffect(() => {
          if (initialId)
            setSelected(DesignData.find((d) => d.id.toString() === initialId));
        }, [initialId]);

        if (selected)
          return (
            <DesignDetail
              item={selected}
              onBack={() => {
                setSelected(null);
                updateURL({ id: null });
              }}
            />
          );

        return (
          <div className="animation-fade-in grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {DesignData.map((item) => (
              <UniversalCard
                key={item.id}
                id={item.id}
                title={item.title}
                subtitle={item.explanation}
                category={item.category}
                onClick={() => setSelected(item)}
              />
            ))}
          </div>
        );
      };

      // =========================================
      // 4. MAIN LAYOUT
      // =========================================
      const InterviewExplorer = () => {
        const [activeTab, setActiveTab] = useState("dsa");
        const [initialId, setInitialId] = useState(null);
        const tabsRef = useRef(null);
        const [canScrollLeft, setCanScrollLeft] = useState(false);
        const [canScrollRight, setCanScrollRight] = useState(false);

        // Parse URL on mount
        useEffect(() => {
          const params = new URLSearchParams(location.search);
          const t = params.get("tab");
          const i = params.get("id");
          if (t) setActiveTab(t);
          if (i) setInitialId(i);
          checkScroll();
          addEventListener("resize", checkScroll);
          return () => removeEventListener("resize", checkScroll);
        }, []);

        const checkScroll = () => {
          if (tabsRef.current) {
            const { scrollLeft, scrollWidth, clientWidth } = tabsRef.current;
            setCanScrollLeft(scrollLeft > 0);
            setCanScrollRight(scrollLeft < scrollWidth - clientWidth - 1);
          }
        };

        const scrollTabs = (dir) => {
          if (tabsRef.current) {
            tabsRef.current.scrollBy({ left: dir * 200, behavior: "smooth" });
            setTimeout(checkScroll, 300);
          }
        };

        const handleTabChange = (id) => {
          setActiveTab(id);
          updateURL({ tab: id, id: null });
          setInitialId(null);
        };

        return (
          <div className="min-h-screen flex flex-col bg-slate-950 text-slate-200 font-sans">
            <nav className="bg-slate-950/80 backdrop-blur-xl border-b border-slate-800/60 sticky top-0 z-50 px-4 py-4">
              <div className="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center gap-4">
                <div className="flex items-center gap-3 group cursor-pointer">
                  <div className="relative bg-gradient-to-br from-blue-600 to-indigo-600 p-2.5 rounded-xl shadow-lg border border-white/10">
                    <span className="text-white font-bold text-xl">üöÄ</span>
                  </div>
                  <div>
                    <h1 className="text-xl font-bold text-white tracking-tight">
                      Fullstack<span className="text-blue-400">Prep</span>
                    </h1>
                    <p className="text-[10px] text-slate-500 font-mono tracking-widest uppercase">
                      Mastery Hub
                    </p>
                  </div>
                </div>

                {/* SCROLLABLE NAVIGATION */}
                <div className="relative group/nav flex items-center max-w-full md:max-w-xl">
                  {canScrollLeft && (
                    <button
                      onClick={() => scrollTabs(-1)}
                      className="absolute left-0 z-10 p-2 bg-gradient-to-r from-slate-950 via-slate-950 to-transparent h-full flex items-center"
                    >
                      <ChevronLeft
                        className="bg-slate-800 rounded-full p-1 shadow-lg border border-slate-700"
                        size={20}
                      />
                    </button>
                  )}

                  <div
                    ref={tabsRef}
                    onScroll={checkScroll}
                    className="flex p-1.5 bg-slate-900/80 rounded-2xl border border-slate-800/80 backdrop-blur-sm overflow-x-auto no-scrollbar scroll-smooth gap-2 w-full"
                  >
                    {[
                      { id: "react", label: "React & JS", icon: "‚öõÔ∏è" },
                      { id: "dsa", label: "Algorithms", icon: "üß†" },
                      { id: "design", label: "System Design", icon: "üìê" },
                      // { id: "patterns", label: "Patterns", icon: "üéØ" },
                    ].map((tab) => {
                      const isActive = activeTab === tab.id;
                      return (
                        <button
                          key={tab.id}
                          onClick={() => handleTabChange(tab.id)}
                          className={`relative px-5 py-2.5 rounded-xl font-bold text-sm transition-all duration-300 ease-out flex items-center gap-2 whitespace-nowrap shrink-0 ${
                            isActive
                              ? "text-white shadow-md bg-slate-800 ring-1 ring-white/10"
                              : "text-slate-400 hover:text-slate-200 hover:bg-slate-800/50"
                          }`}
                        >
                          <span>{tab.icon}</span>
                          <span>{tab.label}</span>
                        </button>
                      );
                    })}
                  </div>

                  {canScrollRight && (
                    <button
                      onClick={() => scrollTabs(1)}
                      className="absolute right-0 z-10 p-2 bg-gradient-to-l from-slate-950 via-slate-950 to-transparent h-full flex items-center"
                    >
                      <ChevronRight
                        className="bg-slate-800 rounded-full p-1 shadow-lg border border-slate-700"
                        size={20}
                      />
                    </button>
                  )}
                </div>
              </div>
            </nav>

            <main className="flex-1 w-full max-w-7xl mx-auto p-4 md:p-8">
              <div key={activeTab} className="animate-tab-content h-full">
                {activeTab === "react" && <ReactView initialId={initialId} />}
                {activeTab === "dsa" && <DSAView initialId={initialId} />}
                {activeTab === "design" && <DesignView initialId={initialId} />}
                {activeTab === "patterns" && (
                  <div className="text-center p-10 text-slate-500 border-2 border-dashed border-slate-800 rounded-xl">
                    Patterns Coming Soon
                  </div>
                )}
              </div>
            </main>

            <footer className="border-t border-slate-800 py-8 mt-auto">
              <div className="max-w-7xl mx-auto px-4 text-center text-slate-500 text-sm">
                <p>
                  Prepared for Technical Interviews. Built with React &
                  Tailwind.
                </p>
              </div>
            </footer>
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<InterviewExplorer />);
    </script>
  </body>
</html>
